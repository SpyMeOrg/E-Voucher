# الوظائف والحسابات

## الحسابات الرئيسية

### 1. حساب USDT المطلوب
```typescript
المبلغ بالجنيه ÷ سعر USDT/EGP = كمية USDT المطلوبة
```

### 2. حساب الدراهم المطلوبة
```typescript
كمية USDT × سعر USDT/AED = إجمالي الدراهم المطلوبة
```

### 3. حساب تكلفة إعادة الشراء
```typescript
كمية USDT × سعر USDT/AED = تكلفة إعادة الشراء بالدرهم
```

### 4. حساب عمولة التاجر
```typescript
كمية USDT × معدل العمولة = عمولة التاجر بالدرهم
```

### 5. حساب صافي الربح
```typescript
إجمالي الدراهم - تكلفة إعادة الشراء - عمولة التاجر = صافي الربح بالدرهم
```

### 6. حساب نسبة الربح
```typescript
(صافي الربح ÷ إجمالي الدراهم) × 100 = نسبة الربح
```

## معالجة ملفات Excel

### 1. قراءة الملف
- قراءة الملف باستخدام مكتبة XLSX
- البحث عن العمود المطلوب ("المبلغ" أو "Amount")
- استخراج القيم وتحويلها إلى أرقام

### 2. تصدير النتائج
- تنظيم النتائج في مصفوفة
- إنشاء ملف Excel جديد
- تصدير البيانات مع التنسيق المناسب

## التحقق من المدخلات

### 1. التحقق من صحة المبالغ
- التأكد من أن المبالغ أرقام صحيحة
- تجاهل الأسطر الفارغة
- معالجة الأخطاء في التنسيق

### 2. التحقق من أسعار الصرف
- التأكد من أن جميع الأسعار موجبة
- التحقق من صحة تنسيق الأرقام
- معالجة حالات القيم الصفرية

## معالجة الأخطاء

### 1. أخطاء الإدخال
- عرض رسائل خطأ واضحة
- منع الحسابات في حالة المدخلات غير الصحيحة
- إرشاد المستخدم للقيم المتوقعة

### 2. أخطاء ملفات Excel
- التحقق من تنسيق الملف
- التأكد من وجود العمود المطلوب
- معالجة حالات البيانات غير المتوقعة

## تحسين الأداء

### 1. تحسين الحسابات
- تجميع العمليات الحسابية
- تجنب الحسابات المتكررة
- تخزين النتائج الوسيطة

### 2. تحسين معالجة الملفات
- قراءة الملفات بكفاءة
- معالجة الملفات الكبيرة
- تحسين عملية التصدير
